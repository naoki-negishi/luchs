[32m[I 231031 12:29:08 training:186][39m Total batch size: 256
[32m[I 231031 12:29:08 training:187][39m Max epoch: 30
[32m[I 231031 12:29:08 training:190][39m Epoch: 1
[32m[I 231031 12:29:08 training:193][39m Training
[36m[D 231031 12:29:08 training:195][39m calculating loss on train set
0it [00:00, ?it/s][33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '3416050480.jpg#4', 'gold_label': 'neutral', 'pairID': '3416050480.jpg#4r1n', 'sentence1': 'A person on a horse jumps over a broken down airplane.', 'sentence1_binary_parse': '( ( ( A person ) ( on ( a horse ) ) ) ( ( jumps ( over ( a ( broken ( down airplane ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (NP (DT A) (NN person)) (PP (IN on) (NP (DT a) (NN horse)))) (VP (VBZ jumps) (PP (IN over) (NP (DT a) (JJ broken) (JJ down) (NN airplane)))) (. .)))', 'sentence2': 'A person is training his horse for a competition.', 'sentence2_binary_parse': '( ( A person ) ( ( is ( ( training ( his horse ) ) ( for ( a competition ) ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT A) (NN person)) (VP (VBZ is) (VP (VBG training) (NP (PRP$ his) (NN horse)) (PP (IN for) (NP (DT a) (NN competition))))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['contradiction'], 'captionID': '3416050480.jpg#4', 'gold_label': 'contradiction', 'pairID': '3416050480.jpg#4r1c', 'sentence1': 'A person on a horse jumps over a broken down airplane.', 'sentence1_binary_parse': '( ( ( A person ) ( on ( a horse ) ) ) ( ( jumps ( over ( a ( broken ( down airplane ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (NP (DT A) (NN person)) (PP (IN on) (NP (DT a) (NN horse)))) (VP (VBZ jumps) (PP (IN over) (NP (DT a) (JJ broken) (JJ down) (NN airplane)))) (. .)))', 'sentence2': 'A person is at a diner, ordering an omelette.', 'sentence2_binary_parse': '( ( A person ) ( ( ( ( is ( at ( a diner ) ) ) , ) ( ordering ( an omelette ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT A) (NN person)) (VP (VBZ is) (PP (IN at) (NP (DT a) (NN diner))) (, ,) (S (VP (VBG ordering) (NP (DT an) (NN omelette))))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['entailment'], 'captionID': '3416050480.jpg#4', 'gold_label': 'entailment', 'pairID': '3416050480.jpg#4r1e', 'sentence1': 'A person on a horse jumps over a broken down airplane.', 'sentence1_binary_parse': '( ( ( A person ) ( on ( a horse ) ) ) ( ( jumps ( over ( a ( broken ( down airplane ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (NP (DT A) (NN person)) (PP (IN on) (NP (DT a) (NN horse)))) (VP (VBZ jumps) (PP (IN over) (NP (DT a) (JJ broken) (JJ down) (NN airplane)))) (. .)))', 'sentence2': 'A person is outdoors, on a horse.', 'sentence2_binary_parse': '( ( A person ) ( ( ( ( is outdoors ) , ) ( on ( a horse ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT A) (NN person)) (VP (VBZ is) (ADVP (RB outdoors)) (, ,) (PP (IN on) (NP (DT a) (NN horse)))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '2267923837.jpg#2', 'gold_label': 'neutral', 'pairID': '2267923837.jpg#2r1n', 'sentence1': 'Children smiling and waving at camera', 'sentence1_binary_parse': '( Children ( ( ( smiling and ) waving ) ( at camera ) ) )', 'sentence1_parse': '(ROOT (NP (S (NP (NNP Children)) (VP (VBG smiling) (CC and) (VBG waving) (PP (IN at) (NP (NN camera)))))))', 'sentence2': 'They are smiling at their parents', 'sentence2_binary_parse': '( They ( are ( smiling ( at ( their parents ) ) ) ) )', 'sentence2_parse': '(ROOT (S (NP (PRP They)) (VP (VBP are) (VP (VBG smiling) (PP (IN at) (NP (PRP$ their) (NNS parents)))))))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['entailment'], 'captionID': '2267923837.jpg#2', 'gold_label': 'entailment', 'pairID': '2267923837.jpg#2r1e', 'sentence1': 'Children smiling and waving at camera', 'sentence1_binary_parse': '( Children ( ( ( smiling and ) waving ) ( at camera ) ) )', 'sentence1_parse': '(ROOT (NP (S (NP (NNP Children)) (VP (VBG smiling) (CC and) (VBG waving) (PP (IN at) (NP (NN camera)))))))', 'sentence2': 'There are children present', 'sentence2_binary_parse': '( There ( ( are children ) present ) )', 'sentence2_parse': '(ROOT (S (NP (EX There)) (VP (VBP are) (NP (NNS children)) (ADVP (RB present)))))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['contradiction'], 'captionID': '2267923837.jpg#2', 'gold_label': 'contradiction', 'pairID': '2267923837.jpg#2r1c', 'sentence1': 'Children smiling and waving at camera', 'sentence1_binary_parse': '( Children ( ( ( smiling and ) waving ) ( at camera ) ) )', 'sentence1_parse': '(ROOT (NP (S (NP (NNP Children)) (VP (VBG smiling) (CC and) (VBG waving) (PP (IN at) (NP (NN camera)))))))', 'sentence2': 'The kids are frowning', 'sentence2_binary_parse': '( ( The kids ) ( are frowning ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NNS kids)) (VP (VBP are) (VP (VBG frowning)))))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['contradiction'], 'captionID': '3691670743.jpg#0', 'gold_label': 'contradiction', 'pairID': '3691670743.jpg#0r1c', 'sentence1': 'A boy is jumping on skateboard in the middle of a red bridge.', 'sentence1_binary_parse': '( ( A boy ) ( ( is ( ( jumping ( on skateboard ) ) ( in ( ( the middle ) ( of ( a ( red bridge ) ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT A) (NN boy)) (VP (VBZ is) (VP (VBG jumping) (PP (IN on) (NP (NN skateboard))) (PP (IN in) (NP (NP (DT the) (NN middle)) (PP (IN of) (NP (DT a) (JJ red) (NN bridge))))))) (. .)))', 'sentence2': 'The boy skates down the sidewalk.', 'sentence2_binary_parse': '( ( The boy ) ( ( ( skates down ) ( the sidewalk ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NN boy)) (VP (VBZ skates) (PRT (RP down)) (NP (DT the) (NN sidewalk))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['entailment'], 'captionID': '3691670743.jpg#0', 'gold_label': 'entailment', 'pairID': '3691670743.jpg#0r1e', 'sentence1': 'A boy is jumping on skateboard in the middle of a red bridge.', 'sentence1_binary_parse': '( ( A boy ) ( ( is ( ( jumping ( on skateboard ) ) ( in ( ( the middle ) ( of ( a ( red bridge ) ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT A) (NN boy)) (VP (VBZ is) (VP (VBG jumping) (PP (IN on) (NP (NN skateboard))) (PP (IN in) (NP (NP (DT the) (NN middle)) (PP (IN of) (NP (DT a) (JJ red) (NN bridge))))))) (. .)))', 'sentence2': 'The boy does a skateboarding trick.', 'sentence2_binary_parse': '( ( The boy ) ( ( does ( a ( skateboarding trick ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NN boy)) (VP (VBZ does) (NP (DT a) (NNP skateboarding) (NN trick))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '3691670743.jpg#0', 'gold_label': 'neutral', 'pairID': '3691670743.jpg#0r1n', 'sentence1': 'A boy is jumping on skateboard in the middle of a red bridge.', 'sentence1_binary_parse': '( ( A boy ) ( ( is ( ( jumping ( on skateboard ) ) ( in ( ( the middle ) ( of ( a ( red bridge ) ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT A) (NN boy)) (VP (VBZ is) (VP (VBG jumping) (PP (IN on) (NP (NN skateboard))) (PP (IN in) (NP (NP (DT the) (NN middle)) (PP (IN of) (NP (DT a) (JJ red) (NN bridge))))))) (. .)))', 'sentence2': 'The boy is wearing safety equipment.', 'sentence2_binary_parse': '( ( The boy ) ( ( is ( wearing ( safety equipment ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NN boy)) (VP (VBZ is) (VP (VBG wearing) (NP (NN safety) (NN equipment)))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '4804607632.jpg#0', 'gold_label': 'neutral', 'pairID': '4804607632.jpg#0r1n', 'sentence1': 'An older man sits with his orange juice at a small table in a coffee shop while employees in bright colored shirts smile in the background.', 'sentence1_binary_parse': '( ( An ( older man ) ) ( ( ( sits ( with ( ( his ( orange juice ) ) ( at ( ( a ( small table ) ) ( in ( a ( coffee shop ) ) ) ) ) ) ) ) ( while ( ( employees ( in ( bright ( colored shirts ) ) ) ) ( smile ( in ( the background ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT An) (JJR older) (NN man)) (VP (VBZ sits) (PP (IN with) (NP (NP (PRP$ his) (JJ orange) (NN juice)) (PP (IN at) (NP (NP (DT a) (JJ small) (NN table)) (PP (IN in) (NP (DT a) (NN coffee) (NN shop))))))) (SBAR (IN while) (S (NP (NP (NNS employees)) (PP (IN in) (NP (JJ bright) (JJ colored) (NNS shirts)))) (VP (VBP smile) (PP (IN in) (NP (DT the) (NN background))))))) (. .)))', 'sentence2': 'An older man drinks his juice as he waits for his daughter to get off work.', 'sentence2_binary_parse': '( ( An ( older man ) ) ( ( ( drinks ( his juice ) ) ( as ( he ( waits ( for ( his ( daughter ( to ( ( get off ) work ) ) ) ) ) ) ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT An) (JJR older) (NN man)) (VP (VBZ drinks) (NP (PRP$ his) (NN juice)) (SBAR (IN as) (S (NP (PRP he)) (VP (VBZ waits) (PP (IN for) (NP (PRP$ his) (NN daughter) (S (VP (TO to) (VP (VB get) (PRT (RP off)) (NP (NN work))))))))))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['contradiction'], 'captionID': '4804607632.jpg#0', 'gold_label': 'contradiction', 'pairID': '4804607632.jpg#0r1c', 'sentence1': 'An older man sits with his orange juice at a small table in a coffee shop while employees in bright colored shirts smile in the background.', 'sentence1_binary_parse': '( ( An ( older man ) ) ( ( ( sits ( with ( ( his ( orange juice ) ) ( at ( ( a ( small table ) ) ( in ( a ( coffee shop ) ) ) ) ) ) ) ) ( while ( ( employees ( in ( bright ( colored shirts ) ) ) ) ( smile ( in ( the background ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT An) (JJR older) (NN man)) (VP (VBZ sits) (PP (IN with) (NP (NP (PRP$ his) (JJ orange) (NN juice)) (PP (IN at) (NP (NP (DT a) (JJ small) (NN table)) (PP (IN in) (NP (DT a) (NN coffee) (NN shop))))))) (SBAR (IN while) (S (NP (NP (NNS employees)) (PP (IN in) (NP (JJ bright) (JJ colored) (NNS shirts)))) (VP (VBP smile) (PP (IN in) (NP (DT the) (NN background))))))) (. .)))', 'sentence2': 'A boy flips a burger.', 'sentence2_binary_parse': '( ( A boy ) ( ( flips ( a burger ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT A) (NN boy)) (VP (VBZ flips) (NP (DT a) (NN burger))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['entailment', 'neutral', 'entailment', 'neutral', 'neutral'], 'captionID': '4804607632.jpg#0', 'gold_label': 'neutral', 'pairID': '4804607632.jpg#0r1e', 'sentence1': 'An older man sits with his orange juice at a small table in a coffee shop while employees in bright colored shirts smile in the background.', 'sentence1_binary_parse': '( ( An ( older man ) ) ( ( ( sits ( with ( ( his ( orange juice ) ) ( at ( ( a ( small table ) ) ( in ( a ( coffee shop ) ) ) ) ) ) ) ) ( while ( ( employees ( in ( bright ( colored shirts ) ) ) ) ( smile ( in ( the background ) ) ) ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (DT An) (JJR older) (NN man)) (VP (VBZ sits) (PP (IN with) (NP (NP (PRP$ his) (JJ orange) (NN juice)) (PP (IN at) (NP (NP (DT a) (JJ small) (NN table)) (PP (IN in) (NP (DT a) (NN coffee) (NN shop))))))) (SBAR (IN while) (S (NP (NP (NNS employees)) (PP (IN in) (NP (JJ bright) (JJ colored) (NNS shirts)))) (VP (VBP smile) (PP (IN in) (NP (DT the) (NN background))))))) (. .)))', 'sentence2': 'An elderly man sits in a small shop.', 'sentence2_binary_parse': '( ( An ( elderly man ) ) ( ( sits ( in ( a ( small shop ) ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT An) (JJ elderly) (NN man)) (VP (VBZ sits) (PP (IN in) (NP (DT a) (JJ small) (NN shop)))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '4705552913.jpg#4', 'gold_label': 'neutral', 'pairID': '4705552913.jpg#4r1n', 'sentence1': 'Two blond women are hugging one another.', 'sentence1_binary_parse': '( ( Two ( blond women ) ) ( ( are ( hugging ( one another ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (CD Two) (JJ blond) (NNS women)) (VP (VBP are) (VP (VBG hugging) (NP (CD one) (DT another)))) (. .)))', 'sentence2': 'Some women are hugging on vacation.', 'sentence2_binary_parse': '( ( Some women ) ( ( are ( hugging ( on vacation ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT Some) (NNS women)) (VP (VBP are) (VP (VBG hugging) (PP (IN on) (NP (NN vacation))))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['contradiction'], 'captionID': '4705552913.jpg#4', 'gold_label': 'contradiction', 'pairID': '4705552913.jpg#4r1c', 'sentence1': 'Two blond women are hugging one another.', 'sentence1_binary_parse': '( ( Two ( blond women ) ) ( ( are ( hugging ( one another ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (CD Two) (JJ blond) (NNS women)) (VP (VBP are) (VP (VBG hugging) (NP (CD one) (DT another)))) (. .)))', 'sentence2': 'The women are sleeping.', 'sentence2_binary_parse': '( ( The women ) ( ( are sleeping ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NNS women)) (VP (VBP are) (VP (VBG sleeping))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['entailment'], 'captionID': '4705552913.jpg#4', 'gold_label': 'entailment', 'pairID': '4705552913.jpg#4r1e', 'sentence1': 'Two blond women are hugging one another.', 'sentence1_binary_parse': '( ( Two ( blond women ) ) ( ( are ( hugging ( one another ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (CD Two) (JJ blond) (NNS women)) (VP (VBP are) (VP (VBG hugging) (NP (CD one) (DT another)))) (. .)))', 'sentence2': 'There are women showing affection.', 'sentence2_binary_parse': '( There ( ( are ( women ( showing affection ) ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (EX There)) (VP (VBP are) (NP (NP (NNS women)) (VP (VBG showing) (NP (NN affection))))) (. .)))'}
[33m[W 231031 12:29:08 iterators:93][39m {'annotator_labels': ['neutral'], 'captionID': '4804607632.jpg#2', 'gold_label': 'neutral', 'pairID': '4804607632.jpg#2r1n', 'sentence1': 'A few people in a restaurant setting, one of them is drinking orange juice.', 'sentence1_binary_parse': '( ( ( A ( few people ) ) ( in ( ( ( a ( restaurant setting ) ) , ) ( one ( of them ) ) ) ) ) ( ( is ( drinking ( orange juice ) ) ) . ) )', 'sentence1_parse': '(ROOT (S (NP (NP (DT A) (JJ few) (NNS people)) (PP (IN in) (NP (NP (DT a) (NN restaurant) (NN setting)) (, ,) (NP (NP (CD one)) (PP (IN of) (NP (PRP them))))))) (VP (VBZ is) (VP (VBG drinking) (NP (JJ orange) (NN juice)))) (. .)))', 'sentence2': 'The people are eating omelettes.', 'sentence2_binary_parse': '( ( The people ) ( ( are ( eating omelettes ) ) . ) )', 'sentence2_parse': '(ROOT (S (NP (DT The) (NNS people)) (VP (VBP are) (VP (VBG eating) (NP (NNS omelettes)))) (. .)))'}
0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/code/training/training.py", line 323, in <module>
    main()
  File "/code/training/training.py", line 317, in main
    finetuning(training_components)
  File "/code/training/training.py", line 196, in finetuning
    train_loss = compute_loss_finetuning(tc)
  File "/code/training/training.py", line 225, in compute_loss_finetuning
    for n_iter, batch in enumerate(tqdm(data_loader), 1):
  File "/usr/local/lib/python3.9/dist-packages/tqdm/std.py", line 1133, in __iter__
    for obj in iterable:
  File "/code/preprocess/iterators.py", line 57, in __next__
    return next(self.batches)
  File "/code/preprocess/iterators.py", line 123, in create_snli_batches
    minibatch_instance = padding(minibatch)
  File "/code/preprocess/iterators.py", line 94, in padding
    premise: list[str] = [instace["sentece1"] for instace in batch]
  File "/code/preprocess/iterators.py", line 94, in <listcomp>
    premise: list[str] = [instace["sentece1"] for instace in batch]
KeyError: 'sentece1'
Traceback (most recent call last):
  File "/code/training/training.py", line 323, in <module>
    main()
  File "/code/training/training.py", line 317, in main
    finetuning(training_components)
  File "/code/training/training.py", line 196, in finetuning
    train_loss = compute_loss_finetuning(tc)
  File "/code/training/training.py", line 225, in compute_loss_finetuning
    for n_iter, batch in enumerate(tqdm(data_loader), 1):
  File "/usr/local/lib/python3.9/dist-packages/tqdm/std.py", line 1133, in __iter__
    for obj in iterable:
  File "/code/preprocess/iterators.py", line 57, in __next__
    return next(self.batches)
  File "/code/preprocess/iterators.py", line 123, in create_snli_batches
    minibatch_instance = padding(minibatch)
  File "/code/preprocess/iterators.py", line 94, in padding
    premise: list[str] = [instace["sentece1"] for instace in batch]
  File "/code/preprocess/iterators.py", line 94, in <listcomp>
    premise: list[str] = [instace["sentece1"] for instace in batch]
KeyError: 'sentece1'